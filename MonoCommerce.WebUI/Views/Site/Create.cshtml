@model MonoCommerce.WebUI.Models.SiteViewModel

@{
    ViewData["Title"] = "Yeni Site Ekle";
}

<div class="container mt-4">
    <h2>Yeni Site Ekle</h2>
    <p class="text-muted">Yeni bir site eklemek iÃ§in aÅŸaÄŸÄ±daki formu doldurun.</p>

    @if (ViewBag.DomainMessage != null)
    {
        <div class="alert alert-info" role="alert">
            @Html.Raw(ViewBag.DomainMessage)
        </div>
    }

    <hr />

    <div class="card p-4 mb-4">
        <!-- ðŸŸ© DOMAIN TEST & EXPORT ALANI -->
        <h4>Domain Ä°ÅŸlemleri (Test)</h4>

        <!-- Domain Kontrol Formu -->
        <form method="post" asp-action="CheckDomain">
            @Html.AntiForgeryToken()
            <input type="hidden" name="url" value="@(Model.Url ?? "testdomain.xyz")" />
            <button type="submit" class="btn btn-primary mb-2">Domain Kontrol Et</button>
        </form>

        <!-- SatÄ±n Alma Butonu -->
        <form method="post" asp-action="PurchaseDomain" class="mb-2">
            @Html.AntiForgeryToken()
            <input type="hidden" name="url" value="@(Model.Url ?? "testdomain.xyz")" />
            <button type="submit" class="btn btn-success">SatÄ±n Al (Test)</button>
        </form>

        <!-- DNS SimÃ¼lasyon Butonu -->
        <form method="post" asp-action="UpdateDnsTest" class="mb-2">
            @Html.AntiForgeryToken()
            <input type="hidden" name="url" value="@(Model.Url ?? "testdomain.xyz")" />
            <button type="submit" class="btn btn-info">DNS SimÃ¼lasyon (Test)</button>
        </form>

        <!-- HTML Export ButonlarÄ± -->
        <form method="post" asp-action="ExportLocal" class="mb-2">
            @Html.AntiForgeryToken()
            <input type="hidden" name="url" value="@(Model.Url ?? "testdomain.xyz")" />
            <input type="hidden" name="htmlContent" value="<h1>Test Export Local</h1><p>Bu HTML test amaÃ§lÄ± export edilmiÅŸtir.</p>" />
            <button type="submit" class="btn btn-warning">HTML Export Local</button>
        </form>

        <form method="post" asp-action="ExportServer" class="mb-2">
            @Html.AntiForgeryToken()
            <input type="hidden" name="url" value="@(Model.Url ?? "testdomain.xyz")" />
            <input type="hidden" name="htmlContent" value="<h1>Test Export Server</h1><p>Bu HTML server simÃ¼lasyonu iÃ§in export edilmiÅŸtir.</p>" />
            <button type="submit" class="btn btn-secondary">HTML Export Server (Simulate)</button>
        </form>

        <!-- UyarÄ± MesajÄ± -->
        @if (ViewBag.Message != null)
        {
            <div class="alert @(ViewBag.IsAvailable == true ? "alert-success" : "alert-danger") mt-3">
                @ViewBag.Message
            </div>
        }

        <!-- Domain DetaylarÄ± -->
        @if (ViewBag.DomainDetails != null)
        {
            <div class="mt-3">
                <h5>Domain DetaylarÄ±:</h5>
                <ul>
                    <li>Status: @ViewBag.DomainDetails.Status</li>
                    <li>Expiration Date: @ViewBag.DomainDetails.ExpirationDate</li>
                    <li>Privacy Enabled: @(ViewBag.DomainDetails.PrivacyEnabled ? "Evet" : "HayÄ±r")</li>
                    <li>Name Servers: @string.Join(", ", ViewBag.DomainDetails.NameServers)</li>
                </ul>
            </div>
        }
    </div>

    <hr />

    <!-- ðŸŸ© SITE OLUÅžTURMA FORMU -->
    <form asp-action="Create" method="post" class="needs-validation" novalidate>
        @Html.AntiForgeryToken()

        @* <!-- URL ALANI -->
        <div class="mb-3">
            <label asp-for="Url" class="form-label"></label>
            <input asp-for="Url" class="form-control" value="@(ViewBag.LastDomain ?? Model.Url ?? "testdomain.xyz")" />
            <span asp-validation-for="Url" class="text-danger"></span>
        </div> *@
        <div class="mb-3">
    <label asp-for="Url" class="form-label"></label>
    <input asp-for="Url" class="form-control" value="@(ViewBag.LastDomain ?? Model.Url ?? "testdomain.xyz")" />
    <span asp-validation-for="Url" class="text-danger"></span>
</div>

        <!-- GENEL ALANLAR -->
        <div class="mb-3">
            <label asp-for="Name" class="form-label"></label>
            <input asp-for="Name" class="form-control" />
            <span asp-validation-for="Name" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Description" class="form-label"></label>
            <textarea asp-for="Description" class="form-control"></textarea>
        </div>

        <div class="mb-3 form-check">
            <input asp-for="IsActive" class="form-check-input" />
            <label asp-for="IsActive" class="form-check-label"></label>
        </div>

        <div class="mb-3">
            <label asp-for="ProductId" class="form-label"></label>
            <select asp-for="ProductId" class="form-select" asp-items="ViewBag.Products">
                <option value="">SeÃ§iniz</option>
            </select>
        </div>

        <div class="mb-3">
            <label asp-for="ImageUrl" class="form-label"></label>
            <input asp-for="ImageUrl" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Prices" class="form-label"></label>
            <input asp-for="Prices" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="PaymentMethod" class="form-label"></label>
            <input asp-for="PaymentMethod" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="Currency" class="form-label"></label>
            <input asp-for="Currency" class="form-control" />
        </div>

        <h5>Ä°letiÅŸim</h5>
        <div class="form-check mb-2">
            <input asp-for="WhatsappEnabled" class="form-check-input" />
            <label asp-for="WhatsappEnabled" class="form-check-label"></label>
        </div>

        <div class="mb-3">
            <label asp-for="WhatsappPhone" class="form-label"></label>
            <input asp-for="WhatsappPhone" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="WhatsappAvailableTime" class="form-label"></label>
            <input asp-for="WhatsappAvailableTime" class="form-control" />
        </div>

        <div class="form-check mb-2">
            <input asp-for="SmsApproval" class="form-check-input" />
            <label asp-for="SmsApproval" class="form-check-label"></label>
        </div>

        <h5>Teknik Alanlar</h5>
        <div class="form-check mb-2">
            <input asp-for="FtpCreated" class="form-check-input" />
            <label asp-for="FtpCreated" class="form-check-label"></label>
        </div>

        <div class="mb-3">
            <label asp-for="Theme" class="form-label"></label>
            <input asp-for="Theme" class="form-control" />
        </div>

        <h5>Pixel & Tracking</h5>
        <div class="mb-3">
            <label asp-for="PixelCode" class="form-label"></label>
            <input asp-for="PixelCode" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="PixelSpecialCode" class="form-label"></label>
            <input asp-for="PixelSpecialCode" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="PixelIds" class="form-label"></label>
            <input asp-for="PixelIds" class="form-control" />
        </div>

        <div class="mb-3">
            <label asp-for="CounterCode" class="form-label"></label>
            <input asp-for="CounterCode" class="form-control" />
        </div>

        <h5>HTML Ä°Ã§erikler</h5>
        <div class="mb-3">
            <label asp-for="HtmlContent" class="form-label"></label>
            <textarea asp-for="HtmlContent" class="form-control" rows="3"></textarea>
        </div>

        <div class="mb-3">
            <label asp-for="FormHtml" class="form-label"></label>
            <textarea asp-for="FormHtml" class="form-control" rows="3"></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Kaydet ve Export</button>
        <a asp-action="Index" class="btn btn-secondary ms-2">Ä°ptal</a>
    </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const urlInput = document.querySelector("input[name='Url']");
    const forms = document.querySelectorAll("form");

    function updateForms(value) {
        forms.forEach(form => {
            const hiddenInput = form.querySelector("input[name='url']");
            if (hiddenInput) hiddenInput.value = value;
        });
    }

    // Sayfa yÃ¼klendiÄŸinde eÅŸitle
    updateForms(urlInput.value);

    // Input deÄŸiÅŸince tÃ¼m hidden inputlarÄ± gÃ¼ncelle
    urlInput.addEventListener("input", () => {
        updateForms(urlInput.value);
    });
});
</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}